# 데이터 타입

### 데이터 타입과 길이 선정
 - 저장되는 값의 성격에 맞는 최적의 타입을 선정
 - 가변 길이 컬럼은 최적의 길이를 지정
 - 조인 조건으로 사용되는 컬럼은 똑같은 데이터 타입으로 선정

### CHAR 와 VARCHAR
>`VARCHAR`타입의 경우 저장된 값의 유효 크기가 얼마인지를 별도로 저장해 둬야 하므로 1~2바이트의 저장 공간이 추가로 더 필요하다.  
>`VARCHAR`타입의 최대 길이는 65,536 바이트 이상으로 설정할 수 없다. (UTF-8 문자를 저장한다면 실제 저장 가능한 글자 수는 1/4로 줄어들 것이다.)

#### 결정 기준
 - 저장되는 문자열의 길이가 대개 비슷한가?
 - 컬럼의 값이 자주 변경되는가?
 > `VARCHAR`의 경우 길이가 더 큰 값으로 변경될 때는 레코드 자체를 다른 공간으로 옮겨서 저장해야 한다.

### 날짜와 시간
 - YEAR
 - DATE
 - TIME
 - DATETIME
 - TIMESTAMP

### TEXT 와 BLOB

#### 다음과 같은 상황에서 사용하는 것이 좋음
 - 컬럼 하나에 저장되는 문자열이나 이진 값의 길이가 예측할 수 없이 클 때 `TEXT`나 `BLOB`을 사용한다.
 - MySQL 버전에 따라 차이는 있지만 일반적으로 하나의 레코드는 전체 크기가 64KB를 넘어설 수 없다. 전체 레코드 크기가 64KB를 넘어서서 더 큰 컬럼을 추가할 수 없다면 일부 컬럼을 TEXT 나 BLOB 으로 전환.

### 가상컬럼 & 스토어드 컬럼
```sql
CREATE TABLE ...
total_price DECIMAL(10,2) AS (quantity * price) STORED,  --STORED
total_price DECIMAL(10,2) AS (quantity * price) VIRTUAL, --VIRTUAL
...
```
#### 가상컬럼
 - 컬럼의 값이 디스크에 저장되지 않음
 - 컬럼의 구조 변경은 테이블 리빌드를 필요로 하지 않음
 - 컬럼의 값은 레코드가 읽히기 전 또는 BEFORE 트리거 실행 직후에 계산되어 만들어짐

#### 스토어드 컬럼
 - 컬럼의 값이 물리적으로 디스크에 저장됨
 - 컬럼의 구조 변경은 다른 일반 테이블과 같이 필요 시 테이블 리빌드 방식으로 처리됨
 - INSERT 와 UPDATE 시점에만 컬럼의 값이 계산됨

> - 가상 컬럼과 스토어드 컬럼의 가장 큰 차이는 계산된 컬럼의 값이 디스크에 실제 저장되는지 여부다.  
> - `선택기준`은 CPU 사용량을 조금 높여서 디스크 부하를 낮출 것이냐, 반대로 디스크 사용량을 조금 높여서 CPU 사용량을 낮출 것이냐다.



